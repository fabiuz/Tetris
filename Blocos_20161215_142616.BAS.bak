'	PROGRAMA:		BLOCKS
' VERSÃO:			1.0
'	AUTOR:			FÁBIO MOURA DE OLIVEIRA
'	DATA: 			14/12/2016
' DESCRIÇÃO:	ESTE PROGRAMA É UM JOGO DE COMPUTADOR SEMELHANTE AO JOGO CLÁSSICO BLOCKS.

#COMPILE EXE
#DIM ALL
#INCLUDE "win32api.inc"

' Nomenclatura do jogo:
' Tabuleiro:	É o local onde os blocos são inseridos.
' Célula:			Interseção entre linha e coluna do tabuleiro.
' Bloco:			Um conjunto de células conectadas a uma outra célula vizinha
'							formando um imagem.
' Peça:				Região, geralmente, em forma quadrática, em que um bloco reside.


' Constantes do jogo
%CELULAS_POR_LINHA = 10
%CELULAS_POR_COLUNA = 10
%CELULAS_TOTAIS = %CELULAS_POR_LINHA * %CELULAS_POR_COLUNA

%CELULA_LARGURA = 10
%CELULA_ALTURA = 10

%BLOCO_LARGURA = 10
%BLOCO_ALTURA = 10

%BLOCO_LINHAS = 3
%BLOCO_COLUNAS = 3

' Indica as coordenadas do canto superior em pixel.
%TABULEIRO_TOPO = 10
%TABULEIRO_ESQUERDA = 10
%TABULEIRO_COR_DE_FUNDO = %RGB_ROYALBLUE
%TABULEIRO_COR_DA_GRADE = %RGB_WHITE
%TABULEIRO_ESPACO_HORIZONTAL_ENTRE_CELULAS = 5
%TABULEIRO_ESPACO_VERTICAL_ENTRE_CELULAS = 5

' Guarda informações sobre uma célula específica.
type celula
	celulaStatus as long	' Indica o estado da célula: 0, não preenchida, 1, preenchida.
	celulaCor as long			' Indica a cor da célula.
end type

' Define o bloco que guardará todas as informações da células
type bloco
	blocoCelula as celula	
end type

FUNCTION PBMAIN () AS LONG
	' Um tabuleiro, é um conjunto de células dispostas em linhas e colunas.
	'local taburo (1 to %CELULAS_POR_LINHA, 1 TO %CELULAS_POR_COLUNA) as celula 
	dim  tabuleiro (1 to %CELULAS_POR_LINHA, 1 TO %CELULAS_POR_COLUNA) as celula
                                                      '
	local janelaBloco as long, bitmapbloco as long
	graphic window new "Blocks v1.0 - Autor Fábio Moura", 0, 0, 500, 500 to janelaBloco
	Graphic bitmap new 500, 500 to bitmapBloco 
	
	' Anexa contexto gráfico.
	graphic attach janelaBloco, 0, redraw
	
	do
		TabuleiroDesenhar()

	loop while asc(graphic$(INKEY$)) <> 27

END FUNCTION

' ********************************************************
' 	Desenha o tabuleiro do jogo
' 	A posição onde o tabuleiro é posicionado
' 	é definido pelas constantes:
' 	%TABULEIRO_TOPO e %TABULEIRO_ESQUERDA
' ********************************************************
sub TabuleiroDesenhar()
	local linha, coluna as long
	
	local celulaSuperiorEsquerda as long
	'local celulaSuperiorDireita as long
	'local celulaInferiorEsquerda as long
	local celulaInferiorDireita as long
	
	
	celulaSuperiorEsquerda = %TABULEIRO_TOPO
	celulaInferiorDireita = celulaSuperiorEsquerda + %CELULA_ALTURA	
	
	for linha = 1 to %CELULAS_POR_LINHA		
		FOR coluna = 1 to %CELULAS_POR_COLUNA
			' Se é a primeira vez do loop, a posição x e y da célula
			' será igual a posição definida nas constantes, %TABULEIRO_ESQUERDA
			' e %TABULEIRO_DIREITA.
			' Cada célula terá um espaço entre elas
			GRAPHIC line (celulaSuperiorEsquerda, celulaSuperiorEsquerda) - _
									 (celulaInferiorDireita, celulaInferiorDireita), %TABULEIRO_COR_DA_GRADE
									 
			celulaSuperiorEsquerda = celulaSuperiorEsquerda + %CELULA_LARGURA + %TABULEIRO_ESPACO_HORIZONTAL_ENTRE_CELULAS						
			celulaInferiorDireita = celulaSuperiorEsquerda + %CELULA_ALTURA			 
		next coluna
	NEXT linha
end sub
